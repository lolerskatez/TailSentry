
{% extends "base.html" %}
{% block title %}Manage Users - TailSentry{% endblock %}
{% block content %}
<div class="max-w-6xl mx-auto py-8 px-4">
        <nav class="flex gap-4 mb-8" aria-label="Settings Subnavigation">
        <a href="/settings" class="px-3 py-1 rounded font-semibold bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-100 hover:bg-indigo-200 hover:text-indigo-900 dark:hover:bg-indigo-800 dark:hover:text-white focus:outline-none focus:ring-2 focus:ring-indigo-500">General</a>
        <a href="/settings/users" class="px-3 py-1 rounded font-semibold bg-indigo-100 text-indigo-800 dark:bg-indigo-900 dark:text-indigo-100 focus:outline-none focus:ring-2 focus:ring-indigo-500" aria-current="page">Manage Users</a>
        <a href="/settings/tailscale" class="px-3 py-1 rounded font-semibold bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-100 hover:bg-indigo-200 hover:text-indigo-900 dark:hover:bg-indigo-800 dark:hover:text-white focus:outline-none focus:ring-2 focus:ring-indigo-500">Tailscale Settings</a>
        <a href="/logs" class="px-3 py-1 rounded font-semibold bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-100 hover:bg-indigo-200 hover:text-indigo-900 dark:hover:bg-gray-800 dark:hover:text-white focus:outline-none focus:ring-2 focus:ring-indigo-500">Logs</a>
    </nav>
    <h1 class="text-2xl font-bold mb-6 text-indigo-800">User Management</h1>
    <div class="overflow-x-auto">
        <table class="min-w-full bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg shadow">
            <thead>
                    <tr>
                        <th class="px-4 py-2">Username</th>
                        <th class="px-4 py-2">Role</th>
                        <th class="px-4 py-2">Created</th>
                        <th class="px-4 py-2">Active</th>
                        <th class="px-4 py-2">Actions</th>
                    </tr>
                </thead>
                <tbody>
                {% for user in users %}
                    <tr>
                        <td class="border px-4 py-2">{{ user.username }}</td>
                        <td class="border px-4 py-2">{{ user.role }}</td>
                        <td class="border px-4 py-2">{{ user.created_at }}</td>
                        <td class="border px-4 py-2">{{ 'Yes' if user.active else 'No' }}</td>
                        <td class="border px-4 py-2">
                            <form method="post" action="/users/delete" style="display:inline;">
                                <input type="hidden" name="username" value="{{ user.username }}">
                                <button type="submit" class="text-red-600 hover:underline" onclick="return confirm('Delete user {{ user.username }}?');">Delete</button>
                            </form>
                            <form method="post" action="/users/role" style="display:inline;">
                                <input type="hidden" name="username" value="{{ user.username }}">
                                <button type="submit" class="text-blue-600 hover:underline">Toggle Role</button>
                            </form>
                            <form method="post" action="/users/active" style="display:inline;">
                                <input type="hidden" name="username" value="{{ user.username }}">
                                <button type="submit" class="text-green-600 hover:underline">Toggle Active</button>
                            </form>
                        </td>
                    </tr>
                {% endfor %}
                </tbody>
            </table>
        </div>
    </main>
{% endblock %}
  
    <div class="flex justify-end mb-6">
        <a href="/settings/users/add" class="inline-flex items-center px-4 py-2 bg-indigo-600 text-white text-sm font-semibold rounded shadow hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500">
            <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" d="M12 4v16m8-8H4"/></svg>
            Add User
        </a>
    </div>

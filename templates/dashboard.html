{% extends 'base.html' %}
{% block title %}Dashboard - TailSentry{% endblock %}
{% block content %}
<h1 class="text-2xl font-bold mb-4">Tailscale Dashboard</h1>
<div class="grid grid-cols-1 md:grid-cols-2 gap-6">
  <div class="bg-white dark:bg-gray-800 p-6 rounded shadow">
    <h2 class="font-semibold mb-2">Device Info</h2>
    <div><b>Hostname:</b> {{ hostname }}</div>
    <div><b>Tailscale IP:</b> {{ ip }}</div>
    <div><b>Role:</b> {{ role }}</div>
  </div>
  <div class="bg-white dark:bg-gray-800 p-6 rounded shadow">
    <h2 class="font-semibold mb-2">Network Stats</h2>
    <div><b>TX:</b> {{ status.Self.TXBytes|default('N/A') }}</div>
    <div><b>RX:</b> {{ status.Self.RXBytes|default('N/A') }}</div>
  </div>
</div>
<div class="mt-8">
  <h2 class="font-semibold mb-2">Connected Peers</h2>
  <div class="overflow-x-auto">
    <table class="min-w-full text-sm">
      <thead>
        <tr class="bg-gray-200 dark:bg-gray-700">
          <th class="p-2">Hostname</th>
          <th class="p-2">IP</th>
          <th class="p-2">OS</th>
          <th class="p-2">Tags</th>
          <th class="p-2">Last Seen</th>
        </tr>
      </thead>
      <tbody>
        {% for peer in peers.values() %}
        <tr class="border-b border-gray-300 dark:border-gray-700">
          <td class="p-2">{{ peer.HostName|default('') }}</td>
          <td class="p-2">{{ peer.TailscaleIPs[0]|default('') }}</td>
          <td class="p-2">{{ peer.OS|default('') }}</td>
          <td class="p-2">{{ peer.Tags|join(', ') if peer.Tags else '' }}</td>
          <td class="p-2">{{ peer.LastSeen|default('') }}</td>
        </tr>
        {% else %}
        <tr><td colspan="5" class="p-2 text-center">No peers connected.</td></tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>
{% endblock %}

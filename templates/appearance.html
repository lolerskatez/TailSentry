{% extends "base.html" %}
{% set show_settings_nav = true %}
{% set active_nav = 'appearance' %}
{% block title %}Appearance Settings - TailSentry{% endblock %}
{% block head %}
    <style>
        .appearance-card {
            transition: all 0.3s ease;
        }
        .appearance-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }
        .theme-option {
            transition: all 0.3s ease;
        }
        .theme-option:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
        }
        .setting-icon {
            width: 64px;
            height: 64px;
            border-radius: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 28px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        .setting-icon.theme {
            background: linear-gradient(135deg, #4f46e5 0%, #7c3aed 100%);
        }
        .setting-icon.interface {
            background: linear-gradient(135deg, #06b6d4 0%, #3b82f6 100%);
        }
        .setting-icon.performance {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
        }
        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 60px;
            height: 34px;
        }
        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        .toggle-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 34px;
        }
        .toggle-slider:before {
            position: absolute;
            content: "";
            height: 26px;
            width: 26px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }
        input:checked + .toggle-slider {
            background-color: #4f46e5;
        }
        input:checked + .toggle-slider:before {
            transform: translateX(26px);
        }
        .compact-mode {
            --spacing-scale: 0.75;
        }
        .compact-mode .p-4 { padding: calc(1rem * var(--spacing-scale)); }
        .compact-mode .p-6 { padding: calc(1.5rem * var(--spacing-scale)); }
        .compact-mode .mb-4 { margin-bottom: calc(1rem * var(--spacing-scale)); }
        .compact-mode .mb-6 { margin-bottom: calc(1.5rem * var(--spacing-scale)); }
        .reduce-motion * {
            animation-duration: 0.01ms !important;
            animation-iteration-count: 1 !important;
            transition-duration: 0.01ms !important;
        }
        /* Custom range slider styling */
        input[type="range"]::-webkit-slider-thumb {
            appearance: none;
            height: 20px;
            width: 20px;
            border-radius: 50%;
            background: #4f46e5;
            cursor: pointer;
        }
        input[type="range"]::-moz-range-thumb {
            height: 20px;
            width: 20px;
            border-radius: 50%;
            background: #4f46e5;
            cursor: pointer;
            border: none;
        }
    </style>
{% endblock %}
{% block content %}
<div class="max-w-7xl mx-auto py-6 px-4" x-data="appearanceSettings()">
    <!-- Toast notification container -->
    <div x-data="{ 
        show: false, 
        message: '', 
        type: '',
        init() {
            window.addEventListener('show-toast', (event) => {
                this.message = event.detail.message;
                this.type = event.detail.type;
                this.show = true;
                setTimeout(() => this.show = false, 3000);
            });
        }
    }" x-show="show" x-transition class="fixed top-6 right-6 z-50">
        <div :class="type === 'success' ? 'bg-green-600' : 'bg-red-600'" class="text-white px-6 py-3 rounded-lg shadow-lg flex items-center gap-2">
            <svg x-show="type === 'success'" class="h-5 w-5" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M5 13l4 4L19 7" /></svg>
            <svg x-show="type === 'error'" class="h-5 w-5" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" /></svg>
            <span x-text="message"></span>
        </div>
    </div>

    <!-- Header Section -->
    <div class="mb-8">
        <div class="text-center mb-6">
            <h1 class="text-4xl font-bold bg-gradient-to-r from-indigo-600 to-purple-600 bg-clip-text text-transparent">
                Appearance Settings
            </h1>
            <p class="mt-2 text-lg text-gray-600 dark:text-gray-400">
                Customize your TailSentry experience
            </p>
        </div>
        
        <!-- Quick Actions Bar -->
        <div class="bg-white dark:bg-gray-800 rounded-2xl shadow-lg p-6 mb-6">
            <div class="flex flex-col sm:flex-row items-start sm:items-center justify-between gap-6">
                <div class="flex items-center space-x-4">
                    <div class="flex items-center">
                        <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200">
                            <span class="w-2 h-2 mr-1 bg-green-500 rounded-full"></span>
                            Theme Active
                        </span>
                    </div>
                    <div class="h-4 w-px bg-gray-300 dark:bg-gray-600"></div>
                    <div class="text-sm text-gray-600 dark:text-gray-400">
                        Current: <span class="font-medium capitalize" x-text="theme"></span>
                    </div>
                </div>
                <div class="flex flex-col sm:flex-row gap-4 w-full sm:w-auto">
                    <button @click="saveAllSettings()" 
                            class="bg-green-600 hover:bg-green-700 text-white font-medium px-6 py-3 rounded-lg transition-all duration-200 transform hover:scale-105 flex items-center justify-center space-x-2 min-w-[140px] shadow-lg">
                        <svg class="w-4 h-4 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                        </svg>
                        <span class="text-white font-medium">Apply Settings</span>
                    </button>
                    <button @click="resetToDefaults()" 
                            class="bg-indigo-600 hover:bg-indigo-700 text-white font-medium px-6 py-3 rounded-lg transition-all duration-200 transform hover:scale-105 flex items-center justify-center space-x-2 min-w-[140px] shadow-lg">
                        <svg class="w-4 h-4 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path>
                        </svg>
                        <span class="text-white font-medium">Reset Defaults</span>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Settings Cards Grid -->
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8">
        <!-- Theme Settings Card -->
        <div class="appearance-card bg-white dark:bg-gray-800 rounded-2xl shadow-lg overflow-hidden">
            <div class="p-6 border-b border-gray-200 dark:border-gray-700">
                <div class="flex items-center justify-between mb-4">
                    <div class="flex items-center space-x-4">
                        <div class="setting-icon theme">
                            üé®
                        </div>
                        <div>
                            <h3 class="text-xl font-semibold text-gray-900 dark:text-white">Theme Preference</h3>
                            <p class="text-gray-600 dark:text-gray-400">Choose your visual style</p>
                        </div>
                    </div>
                </div>
                <div class="flex items-center space-x-2">
                    <span class="w-3 h-3 rounded-full bg-green-500"></span>
                    <span class="text-sm text-gray-600 dark:text-gray-400">
                        Current: <span class="font-medium capitalize" x-text="theme"></span>
                    </span>
                </div>
            </div>
            
            <div class="p-6 space-y-6">
                <!-- Theme Selection Grid -->
                <div class="grid grid-cols-1 gap-4">
                    <!-- System Theme -->
                    <label class="relative cursor-pointer theme-option">
                        <input type="radio" name="theme" value="system" x-model="theme" class="sr-only" @change="applyTheme()">
                        <div :class="theme === 'system' ? 'ring-2 ring-indigo-500 bg-gradient-to-r from-indigo-50 to-purple-50 dark:from-indigo-900/20 dark:to-purple-900/20' : 'bg-gray-50 dark:bg-gray-700'" 
                             class="border border-gray-200 dark:border-gray-600 rounded-xl p-4 transition-all hover:shadow-md">
                            <div class="flex items-center space-x-4">
                                <div class="flex-shrink-0">
                                    <svg class="w-8 h-8 text-gray-600 dark:text-gray-400" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" d="M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"></path>
                                    </svg>
                                </div>
                                <div class="flex-1">
                                    <div class="font-medium text-gray-900 dark:text-white">System Default</div>
                                    <div class="text-sm text-gray-500 dark:text-gray-400">Follow your device preferences</div>
                                </div>
                                <div x-show="theme === 'system'" class="flex-shrink-0">
                                    <svg class="w-5 h-5 text-indigo-600" fill="currentColor" viewBox="0 0 20 20">
                                        <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path>
                                    </svg>
                                </div>
                            </div>
                        </div>
                    </label>

                    <!-- Light Theme -->
                    <label class="relative cursor-pointer theme-option">
                        <input type="radio" name="theme" value="light" x-model="theme" class="sr-only" @change="applyTheme()">
                        <div :class="theme === 'light' ? 'ring-2 ring-indigo-500 bg-gradient-to-r from-indigo-50 to-purple-50 dark:from-indigo-900/20 dark:to-purple-900/20' : 'bg-gray-50 dark:bg-gray-700'" 
                             class="border border-gray-200 dark:border-gray-600 rounded-xl p-4 transition-all hover:shadow-md">
                            <div class="flex items-center space-x-4">
                                <div class="flex-shrink-0">
                                    <svg class="w-8 h-8 text-yellow-500" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"></path>
                                    </svg>
                                </div>
                                <div class="flex-1">
                                    <div class="font-medium text-gray-900 dark:text-white">Light Mode</div>
                                    <div class="text-sm text-gray-500 dark:text-gray-400">Bright and clean interface</div>
                                </div>
                                <div x-show="theme === 'light'" class="flex-shrink-0">
                                    <svg class="w-5 h-5 text-indigo-600" fill="currentColor" viewBox="0 0 20 20">
                                        <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path>
                                    </svg>
                                </div>
                            </div>
                        </div>
                    </label>

                    <!-- Dark Theme -->
                    <label class="relative cursor-pointer theme-option">
                        <input type="radio" name="theme" value="dark" x-model="theme" class="sr-only" @change="applyTheme()">
                        <div :class="theme === 'dark' ? 'ring-2 ring-indigo-500 bg-gradient-to-r from-indigo-50 to-purple-50 dark:from-indigo-900/20 dark:to-purple-900/20' : 'bg-gray-50 dark:bg-gray-700'" 
                             class="border border-gray-200 dark:border-gray-600 rounded-xl p-4 transition-all hover:shadow-md">
                            <div class="flex items-center space-x-4">
                                <div class="flex-shrink-0">
                                    <svg class="w-8 h-8 text-gray-700 dark:text-gray-300" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"></path>
                                    </svg>
                                </div>
                                <div class="flex-1">
                                    <div class="font-medium text-gray-900 dark:text-white">Dark Mode</div>
                                    <div class="text-sm text-gray-500 dark:text-gray-400">Easy on the eyes</div>
                                </div>
                                <div x-show="theme === 'dark'" class="flex-shrink-0">
                                    <svg class="w-5 h-5 text-indigo-600" fill="currentColor" viewBox="0 0 20 20">
                                        <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path>
                                    </svg>
                                </div>
                            </div>
                        </div>
                    </label>
                </div>

                <!-- Theme Preview -->
                <div class="bg-gray-100 dark:bg-gray-700 rounded-xl p-4">
                    <h4 class="text-sm font-medium text-gray-700 dark:text-gray-300 mb-3">Preview</h4>
                    <div class="border border-gray-300 dark:border-gray-600 rounded-lg overflow-hidden">
                        <div :class="getPreviewClasses()" class="p-4 transition-all">
                            <div class="flex items-center justify-between mb-3">
                                <h5 class="font-semibold">TailSentry Dashboard</h5>
                                <div class="w-3 h-3 rounded-full bg-green-500"></div>
                            </div>
                            <div class="space-y-2">
                                <div class="h-2 bg-current opacity-20 rounded"></div>
                                <div class="h-2 bg-current opacity-15 rounded w-3/4"></div>
                                <div class="h-2 bg-current opacity-10 rounded w-1/2"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Interface Settings Card -->
        <div class="appearance-card bg-white dark:bg-gray-800 rounded-2xl shadow-lg overflow-hidden">
            <div class="p-6 border-b border-gray-200 dark:border-gray-700">
                <div class="flex items-center justify-between mb-4">
                    <div class="flex items-center space-x-4">
                        <div class="setting-icon interface">
                            ‚öôÔ∏è
                        </div>
                        <div>
                            <h3 class="text-xl font-semibold text-gray-900 dark:text-white">Interface Settings</h3>
                            <p class="text-gray-600 dark:text-gray-400">Customize your dashboard experience</p>
                        </div>
                    </div>
                </div>
                <div class="flex items-center space-x-2">
                    <span class="w-3 h-3 rounded-full bg-blue-500"></span>
                    <span class="text-sm text-gray-600 dark:text-gray-400">Refresh: <span class="font-medium" x-text="refreshInterval + 's'"></span></span>
                </div>
            </div>
            
            <div class="p-6 space-y-6">
                <!-- Refresh Interval -->
                <div class="bg-gray-50 dark:bg-gray-700 rounded-xl p-4">
                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3" for="refresh-interval">
                        Dashboard Refresh Interval
                    </label>
                    <div class="flex items-center space-x-4">
                        <input 
                            id="refresh-interval" 
                            type="range" 
                            min="5" 
                            max="120" 
                            step="5"
                            x-model.number="refreshInterval" 
                            class="flex-1 h-2 bg-gray-200 dark:bg-gray-600 rounded-lg appearance-none cursor-pointer"
                            @input="saveRefreshInterval()">
                        <div class="flex items-center space-x-2 min-w-[100px]">
                            <span x-text="refreshInterval" class="font-bold text-indigo-600 text-lg"></span>
                            <span class="text-sm text-gray-500 dark:text-gray-400">seconds</span>
                        </div>
                    </div>
                    <div class="mt-3 flex justify-between text-xs text-gray-500 dark:text-gray-400">
                        <span>Fast (5s)</span>
                        <span>Balanced (30s)</span>
                        <span>Slow (120s)</span>
                    </div>
                </div>

                <!-- Interface Options -->
                <div class="space-y-4">
                    <!-- Compact Mode -->
                    <div class="flex items-center justify-between p-4 bg-gray-50 dark:bg-gray-700 rounded-xl">
                        <div class="flex-1">
                            <div class="flex items-center space-x-3">
                                <svg class="w-5 h-5 text-indigo-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 10h16M4 14h16M4 18h16"></path>
                                </svg>
                                <div>
                                    <label class="text-sm font-medium text-gray-700 dark:text-gray-300">Compact Mode</label>
                                    <p class="text-sm text-gray-500 dark:text-gray-400">Reduce spacing for more information density</p>
                                </div>
                            </div>
                        </div>
                        <label class="toggle-switch">
                            <input type="checkbox" x-model="compactMode" @change="saveCompactMode()">
                            <span class="toggle-slider"></span>
                        </label>
                    </div>

                    <!-- Reduce Animations -->
                    <div class="flex items-center justify-between p-4 bg-gray-50 dark:bg-gray-700 rounded-xl">
                        <div class="flex-1">
                            <div class="flex items-center space-x-3">
                                <svg class="w-5 h-5 text-indigo-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                                </svg>
                                <div>
                                    <label class="text-sm font-medium text-gray-700 dark:text-gray-300">Reduce Animations</label>
                                    <p class="text-sm text-gray-500 dark:text-gray-400">Minimize transitions for better performance</p>
                                </div>
                            </div>
                        </div>
                        <label class="toggle-switch">
                            <input type="checkbox" x-model="reduceAnimations" @change="saveReduceAnimations()">
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Performance & Accessibility Card -->
    <div class="appearance-card bg-white dark:bg-gray-800 rounded-2xl shadow-lg overflow-hidden mb-8">
        <div class="p-6 border-b border-gray-200 dark:border-gray-700">
            <div class="flex items-center justify-between mb-4">
                <div class="flex items-center space-x-4">
                    <div class="setting-icon performance">
                        üöÄ
                    </div>
                    <div>
                        <h3 class="text-xl font-semibold text-gray-900 dark:text-white">Performance & Accessibility</h3>
                        <p class="text-gray-600 dark:text-gray-400">Optimize your experience</p>
                    </div>
                </div>
            </div>
            <div class="flex items-center space-x-2">
                <span class="w-3 h-3 rounded-full bg-green-500"></span>
                <span class="text-sm text-gray-600 dark:text-gray-400">Settings optimized for your device</span>
            </div>
        </div>
        
        <div class="p-6">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <!-- Performance Tips -->
                <div class="bg-gradient-to-r from-green-50 to-emerald-50 dark:from-green-900/20 dark:to-emerald-900/20 border border-green-200 dark:border-green-700/50 rounded-xl p-5">
                    <div class="flex items-start space-x-3">
                        <div class="flex-shrink-0">
                            <svg class="w-5 h-5 text-green-600 dark:text-green-400 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                        <div class="flex-1">
                            <h4 class="font-medium text-green-900 dark:text-green-300 mb-2">Performance Tips</h4>
                            <ul class="text-sm text-green-800 dark:text-green-400 space-y-1">
                                <li>‚Ä¢ Use longer refresh intervals for better battery life</li>
                                <li>‚Ä¢ Enable compact mode on smaller screens</li>
                                <li>‚Ä¢ Reduce animations for older devices</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- Accessibility Info -->
                <div class="bg-gradient-to-r from-blue-50 to-indigo-50 dark:from-blue-900/20 dark:to-indigo-900/20 border border-blue-200 dark:border-blue-700/50 rounded-xl p-5">
                    <div class="flex items-start space-x-3">
                        <div class="flex-shrink-0">
                            <svg class="w-5 h-5 text-blue-600 dark:text-blue-400 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.746 0 3.332.477 4.5 1.253v13C19.832 18.477 18.246 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"></path>
                            </svg>
                        </div>
                        <div class="flex-1">
                            <h4 class="font-medium text-blue-900 dark:text-blue-300 mb-2">Accessibility</h4>
                            <ul class="text-sm text-blue-800 dark:text-blue-400 space-y-1">
                                <li>‚Ä¢ Respects system motion preferences</li>
                                <li>‚Ä¢ High contrast support included</li>
                                <li>‚Ä¢ Keyboard navigation friendly</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
document.addEventListener('alpine:init', () => {
    Alpine.data('appearanceSettings', () => ({
        theme: localStorage.getItem('theme') || 'system',
        refreshInterval: parseInt(localStorage.getItem('refreshInterval') || '30'),
        compactMode: localStorage.getItem('compactMode') === 'true',
        reduceAnimations: localStorage.getItem('reduceAnimations') === 'true',

        init() {
            // Apply current theme on load
            this.applyTheme();
            
            // Apply compact mode and animations
            this.applyCompactMode();
            this.applyAnimations();

            // Watch for system theme changes
            if (this.theme === 'system') {
                window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', () => {
                    if (this.theme === 'system') {
                        this.applyTheme();
                    }
                });
            }
        },

        applyTheme() {
            const isDark = this.theme === 'dark' || 
                          (this.theme === 'system' && window.matchMedia('(prefers-color-scheme: dark)').matches);
            
            if (isDark) {
                document.documentElement.classList.add('dark');
            } else {
                document.documentElement.classList.remove('dark');
            }

            // Save theme preference
            localStorage.setItem('theme', this.theme);
            
            // Emit global theme change event for other components
            window.dispatchEvent(new CustomEvent('theme-changed', {
                detail: { theme: this.theme, isDark }
            }));
            
            // Show toast notification
            this.showToast('Theme applied successfully!', 'success');
        },

        saveRefreshInterval() {
            localStorage.setItem('refreshInterval', this.refreshInterval.toString());
        },

        saveCompactMode() {
            localStorage.setItem('compactMode', this.compactMode.toString());
            this.applyCompactMode();
        },

        applyCompactMode() {
            if (this.compactMode) {
                document.documentElement.classList.add('compact-mode');
            } else {
                document.documentElement.classList.remove('compact-mode');
            }
        },

        saveReduceAnimations() {
            localStorage.setItem('reduceAnimations', this.reduceAnimations.toString());
            this.applyAnimations();
        },

        applyAnimations() {
            if (this.reduceAnimations) {
                document.documentElement.classList.add('reduce-motion');
            } else {
                document.documentElement.classList.remove('reduce-motion');
            }
        },

        getPreviewClasses() {
            if (this.theme === 'dark') {
                return 'bg-gray-900 text-white';
            } else if (this.theme === 'light') {
                return 'bg-white text-gray-900';
            } else {
                // System theme - show current applied theme
                const isDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
                return isDark ? 'bg-gray-900 text-white' : 'bg-white text-gray-900';
            }
        },

        saveAllSettings() {
            this.applyTheme();
            this.saveRefreshInterval();
            this.saveCompactMode();
            this.saveReduceAnimations();
            
            this.showToast('All appearance settings saved!', 'success');
        },

        resetToDefaults() {
            this.theme = 'system';
            this.refreshInterval = 30;
            this.compactMode = false;
            this.reduceAnimations = false;

            // Apply defaults
            this.applyTheme();
            this.saveRefreshInterval();
            this.saveCompactMode();
            this.saveReduceAnimations();

            this.showToast('Settings reset to defaults', 'success');
        },

        showToast(message, type) {
            // Use Alpine's global store or dispatch custom event
            window.dispatchEvent(new CustomEvent('show-toast', {
                detail: { message, type }
            }));
        }
    }));
});
</script>
{% endblock %}
